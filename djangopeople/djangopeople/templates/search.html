{% extends "maps.html" %}
{% load person_list_items sekizai_tags %}

{% block title %}{% if q %}{% blocktrans %}Search: {{ q }}{% endblocktrans %}{% else %}{% trans "Search" %}{% endif %} |{% endblock %}

{% block nav_li_class_search %} class="current"{% endblock %}

{% block header %}
	<form action="{% url "search" %}" method="GET" class="search">
		<h1><label for="q">{% if q %}{% blocktrans %}Search: {{ q }}{% endblocktrans %}{% else %}{% trans "Search" %}{% endif %}</label></h1>
		{% if people_list %}<p class="meta">{% blocktrans count counter=people_list|length %}{{ counter }} result{% plural %}{{ counter }} results{% endblocktrans %}</p>{% endif %}
		{% if has_badwords %}<p class="help"><strong>{% trans "Terms must be three or more characters" %}</strong></p>{% endif %}
		<p><input type="text" name="q" id="q" value="{{ q }}"> <input type="submit" class="submit" value="{% trans "Search" %}"></p>
		<p>{% trans "This tool searches by username, first name and last name." %}</p>
	</form>
{% endblock %}

{% block map %}
	{% if people_list %}
		<div class="mapContainer major">
			<div id="map">&nbsp;</div>
		</div>
	{% endif %}
{% endblock %}

{% block content %}
	{% if q and not people_list %}
		<p>{% trans "No users found." %}</p>
	{% endif %}
	{% if people_list %}
		<ul class="detailsList split">
			{% person_list_items people_list %}
		</ul>
	{% endif %}
{% endblock %}

{% block map_extra_options %}
<script type="text/javascript">
	var south, north, west, east;
	$.each(people, function(index, value) {
		if (!index) {
			south = value[0];
			north = value[0];
			east = value[1];
			west = value[1];
		}
		south = Math.min(value[0], south);
		north = Math.max(value[0], north);
		east = Math.max(value[1], east);
		west = Math.min(value[1], west);
	});
	var swBound = new L.LatLng(south, west);
	var neBound = new L.LatLng(north, east);
	var boundBox = new L.LatLngBounds(swBound, neBound);
</script>
{% endblock %}

{% block post_map_init %}
	MAP.fitBounds(boundBox);
{% endblock %}
